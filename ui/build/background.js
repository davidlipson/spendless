/*! For license information please see background.js.LICENSE.txt */
!function(){"use strict";var e={6489:function(e,t){t.Q=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var o={},i=t||{},s=e.split(";"),c=i.decode||n,a=0;a<s.length;a++){var u=s[a],d=u.indexOf("=");if(!(d<0)){var f=u.substring(0,d).trim();if(null==o[f]){var l=u.substring(d+1,u.length).trim();'"'===l[0]&&(l=l.slice(1,-1)),o[f]=r(l,c)}}}return o},t.q=function(e,t,n){var r=n||{},s=r.encode||o;if("function"!=typeof s)throw new TypeError("option encode is invalid");if(!i.test(e))throw new TypeError("argument name is invalid");var c=s(t);if(c&&!i.test(c))throw new TypeError("argument val is invalid");var a=e+"="+c;if(null!=r.maxAge){var u=r.maxAge-0;if(isNaN(u)||!isFinite(u))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(u)}if(r.domain){if(!i.test(r.domain))throw new TypeError("option domain is invalid");a+="; Domain="+r.domain}if(r.path){if(!i.test(r.path))throw new TypeError("option path is invalid");a+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a};var n=decodeURIComponent,o=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function r(e,t){try{return t(e)}catch(t){return e}}},9659:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.updateBudget=void 0;const i=n(824);t.updateBudget=(e,t)=>o(void 0,void 0,void 0,(function*(){const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e,budget:t})},o=`${i.host}/budget`;yield fetch(o,n)}))},9265:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHistory=void 0;const i=n(824);t.getHistory=e=>o(void 0,void 0,void 0,(function*(){try{const t=`${i.host}/history?uid=${e}`,n=yield fetch(t);return yield n.json()}catch(e){return{history:[],spent:0}}}))},5639:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ignoreTransaction=void 0;const i=n(824);t.ignoreTransaction=(e,t)=>o(void 0,void 0,void 0,(function*(){const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e,id:t})},o=`${i.host}/ignore`;yield fetch(o,n)}))},395:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(9659),t),i(n(9265),t),i(n(1103),t),i(n(1423),t),i(n(83),t),i(n(5639),t),i(n(824),t)},1103:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.onboardUser=t.loginUser=void 0;const r=i(n(9585)),s=n(824),c=n(1230),a=new r.default;t.loginUser=(e,t=!1)=>o(void 0,void 0,void 0,(function*(){try{const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:e.givenName,last_name:e.familyName,email:e.email})},o=`${s.host}/login`,i=yield fetch(o,n),r=yield i.json();return t&&a.set(c.SPENDLO_COOKIE,r[0].id,{path:"/"}),r[0]}catch(e){return console.log(e),!1}})),t.onboardUser=e=>o(void 0,void 0,void 0,(function*(){try{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e})},n=`${s.host}/onboard`,o=yield fetch(n,t);return(yield o.json())[0]}catch(e){return console.log(e),!1}}))},1423:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getRecent=void 0;const i=n(824);t.getRecent=e=>o(void 0,void 0,void 0,(function*(){try{const t=`${i.host}/recent?uid=${e}`,n=yield fetch(t);return(yield n.json())[0]}catch(e){return console.log(e),null}}))},83:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlList=void 0;const i=n(824);t.getUrlList=()=>o(void 0,void 0,void 0,(function*(){try{const e=`${i.host}/list`,t=yield fetch(e);return yield t.json()}catch(e){return{whitelist:{},blacklist:[],totalRegex:null,processButtons:[],processButtonEndWords:[]}}}))},8136:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(4104);o(void 0,void 0,void 0,(function*(){chrome.webNavigation.onHistoryStateUpdated.addListener((e=>o(void 0,void 0,void 0,(function*(){i.domManager.navHelper(e)})))),chrome.webNavigation.onCompleted.addListener((e=>o(void 0,void 0,void 0,(function*(){i.domManager.navHelper(e)}))))}))},516:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.domManager=void 0;const i=n(395);t.domManager=new class{constructor(){this.loginUser=e=>o(this,void 0,void 0,(function*(){this.user=yield(0,i.loginUser)({email:e})})),this.sendMessage=(e,t)=>{chrome.tabs.sendMessage(e,t)},this.navHelper=e=>o(this,void 0,void 0,(function*(){const{tabId:t,url:n}=e;if(this.lists=yield(0,i.getUrlList)(),console.log(e),void 0!==e.url&&0===e.frameId){let e=!1;for(const[r,s]of Object.entries(this.lists.whitelist)){const c=s.regex,a=s.query,u=s.description;c.forEach((s=>{let c=new RegExp(s,"i");(null==n?void 0:n.match(c))&&!e&&(e=!0,this.lists.blacklist.find((e=>{let t=new RegExp(e,"i");return n.match(t)}))||chrome.identity.getProfileUserInfo((e=>o(this,void 0,void 0,(function*(){if(yield this.loginUser(e.email),this.user){let e=yield(0,i.getRecent)(this.user.id);this.sendMessage(t,{recent:e,page:r,query:a,description:u,url:n,user:this.user,totalRegex:this.lists.totalRegex,processButtons:this.lists.processButtons,processButtonEndWords:this.lists.processButtonEndWords})}})))))}))}}})),this.user=null}}},4104:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(516),t)},824:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.dev=t.host=void 0,t.host="http://localhost:5000",t.dev=!0},2703:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},5161:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SPENDLO_COOKIE=void 0,t.SPENDLO_COOKIE="SpendLoUserCookie"},664:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},9439:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},1230:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(9439),t),i(n(664),t),i(n(2703),t),i(n(5161),t)},9585:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var o=n(6489);function i(e,t){void 0===t&&(t={});var n=function(e){return e&&"j"===e[0]&&":"===e[1]?e.substr(2):e}(e);if(function(e,t){return void 0===t&&(t=!e||"{"!==e[0]&&"["!==e[0]&&'"'!==e[0]),!t}(n,t.doNotParse))try{return JSON.parse(n)}catch(e){}return e}var r=function(){return r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},s=function(){function e(e,t){var n=this;this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.cookies=function(e,t){return"string"==typeof e?o.Q(e,t):"object"==typeof e&&null!==e?e:{}}(e,t),new Promise((function(){n.HAS_DOCUMENT_COOKIE="object"==typeof document&&"string"==typeof document.cookie})).catch((function(){}))}return e.prototype._updateBrowserValues=function(e){this.HAS_DOCUMENT_COOKIE&&(this.cookies=o.Q(document.cookie,e))},e.prototype._emitChange=function(e){for(var t=0;t<this.changeListeners.length;++t)this.changeListeners[t](e)},e.prototype.get=function(e,t,n){return void 0===t&&(t={}),this._updateBrowserValues(n),i(this.cookies[e],t)},e.prototype.getAll=function(e,t){void 0===e&&(e={}),this._updateBrowserValues(t);var n={};for(var o in this.cookies)n[o]=i(this.cookies[o],e);return n},e.prototype.set=function(e,t,n){var i;"object"==typeof t&&(t=JSON.stringify(t)),this.cookies=r(r({},this.cookies),((i={})[e]=t,i)),this.HAS_DOCUMENT_COOKIE&&(document.cookie=o.q(e,t,n)),this._emitChange({name:e,value:t,options:n})},e.prototype.remove=function(e,t){var n=t=r(r({},t),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=r({},this.cookies),delete this.cookies[e],this.HAS_DOCUMENT_COOKIE&&(document.cookie=o.q(e,"",n)),this._emitChange({name:e,value:void 0,options:t})},e.prototype.addChangeListener=function(e){this.changeListeners.push(e)},e.prototype.removeChangeListener=function(e){var t=this.changeListeners.indexOf(e);t>=0&&this.changeListeners.splice(t,1)},e}()}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8136)}();